#Concept of Geant4

### 정의해야 하는 것들

Geant4 시뮬레이션을 하기 위해 정의해야 하는 기본적인 3가지가 있다. Physics List(물리?), 물질 그리고 빔이다.

여기서 말하는 Physics List는 우리가 시뮬레이션 하려는 입자에 적용하게 될 물리를 말한다.
Compton Scattering 같은 물리 현상도 있고 입자 생성 threshold 같은 값도 정의 할 수 있다.
모든 물리가 정의되어 있으면 가장 좋겠지만 시뮬레이션을 하다보면 그것이 불가능하다는 것을 알게 될 것이다.
처음에는 이 부분을 이해하기 어렵기 때문에 Geant4에서 제공되는 기본 세트를 사용 하겠지만
나중에 보다 정밀한 시뮬레이션을 하기 위해서는 알아두어야 한다.

물질은 우리의 경우 대부분이 검출기에 해당된다. 당연하지만 시뮬레이션이 수행될 세계 또한 하나의 물질로서 정의해야 한다.
세계는 조금 특별한 공간인데 어떤 입자가 세계의 틀을 벗어나면 그 입자에 대한 시뮬레이션은 끝난다.
물질을 정의할때는 그 모양, 크기, 위치, 화학 성분, 밀도, 물질간의 상하관계를 알아야 한다.
상하 관계란 어떤 물질이 어떤 다른 물질에 속하지를 말한다.
예를 들어서 검출기는 세계 안에 존재하므로 셰계는 검출기의 상위 물질이고 검출기는 세계의 하위물질이다.
같은 물리적인 공간에서 물리는 하위 물질이 우선순위로 작용한다. 

마지막으로 처음 쏘아줄 빔, 즉 입자를 적의 해야 한다. 간단하게 입자의 종류, 시작 위치, 진행방향, 처음 가지고 시작하는 에너지를 정의해주면 된다.

### 시뮬레이션 단계

Geant4 시뮬레이션에서 우리가 수동적으로 다룰 수 있는 단계는 트랙(Track) 그리고 스탭(Step) 이 있다.

트랙은 하나의 입자의 궤적을 말하는데 입자가 생성되어서 없어지거나 세계 밖으로 나갈 때까지 유지된다.

스텝은 트랙의 하위 개념이다. 우리는 실제 물리를 관찰하는게 아닌 컴퓨터를 이용한 시뮬레이션을 하고 있기 때문에 완벽하게 연속적인 트랙을 만들 수 없다. 따라서 우리는 어느정도까지 세밀하게 트랙을 나눌 것인지를 결정해야 한다. 이것을 결정하는것이 앞서 말한 Physics List의 스텝 크기에 해당한다. Geant4는 어떤 입자에 대해서 시뮬레이션을 할때 한 스텝만큼을 한번에 계산을 한다. 하나의 스텝은 두개의 점으로 이루어지며 그 두 점사이에 어떤 물리 과정에 의해서 무슨일이 일어났는지를 알려준다. 대부분의 물리 과정은 transportaion에 해당되지만 가끔 입자를 생성하거나 물질에 에너지를 남기기도 하며 없어지기도 한다. 

스텝에서 주의할 점은 입자가 없어지거나 에너지를 남기는 과정도 실제로는 입자를 생성하는 과정일수 있다는 사실이다. 예를 들어서 가스를 지나가는 전하를 띈 입자가 있는데 이 입자의 경로가 궁금하다고 하자. 이 입자는 가스를 지나가면서 가스 분자를 이온화시켜 수 많은 전자를 생성한다. 만약에 이 과정을 시뮬레이션으로 모두 계산하게 된다면 어마어마한 시간이 걸릴 것이다. 따라서 우리는 전자의 생성 컷을 주어서 억제시킬 필요가 있는데 이 또한 Physics List에서 설정할 수 있다. 이렇게 전자의 생성을 억제 시키면 원래 분자를 이온화시켜야 했던 에너지는 스텝안에서 잃어버린 에너지로 남는다. 

공식 메뉴얼에는 잃어버린 에너지에 대해서 다음과 같이 쓰여있다. 
> Total energy deposited during the step - this is the sum of
> - the energy deposited by the energy loss process, and
> - the energy lost by secondaries which have NOT been generated because each of their energies was below the cut threhold.

즉 입자가 잃어버린 에너지는 '입자가 직접 잃어버린 에너지' + '생성 컷에 의해서 생성되지 않은 입자가 물질 안에서 남겼을 에너지' 가 된다. 나중에 시뮬레이션 데이터를 분석할 때 많이 햇갈리는 부분이므로 명확하게 하고 넘어가도록 하자.

앞서 말했듯이 스텝은 두개의 점으로 이루어져 있다. 하나의 트랙은 스텝의 연속으로 이루어져 있으므로 한 스텝의 끝점은 그 다음 스텝의 시작점이 된다.
